<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head th:replace="_fragments/header :: head">
    <title>사용자 상세 - CLD4 Archive</title>
  </head>
  <body class="d-flex flex-column min-vh-100">
    <div th:replace="_fragments/header :: header"></div>

    <main class="container mt-4 flex-grow-1">
      <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
          <div class="card">
            <div class="card-header bg-white border-bottom">
              <h1 class="h4 mb-0">
                <i class="bi bi-person-lines-fill"></i> 사용자 상세
              </h1>
            </div>
            <div class="card-body">
              <div class="row mb-3">
                <div class="col-4">
                  <strong class="text-muted">
                    <i class="bi bi-hash"></i> ID
                  </strong>
                </div>
                <div class="col-8">
                  <span class="badge bg-secondary fs-6" th:text="${user.id}"
                    >1</span
                  >
                </div>
              </div>

              <div class="row mb-3">
                <div class="col-4">
                  <strong class="text-muted">
                    <i class="bi bi-person"></i> 이름
                  </strong>
                </div>
                <div class="col-8">
                  <span th:text="${user.name}">홍길동</span>
                </div>
              </div>

              <div class="row mb-3">
                <div class="col-4">
                  <strong class="text-muted">
                    <i class="bi bi-envelope"></i> 이메일
                  </strong>
                </div>
                <div class="col-8">
                  <a
                    th:href="'mailto:' + ${user.email}"
                    class="text-decoration-none"
                  >
                    <span th:text="${user.email}">email@example.com</span>
                  </a>
                </div>
              </div>

              <div class="row mb-3">
                <div class="col-4">
                  <strong class="text-muted">
                    <i class="bi bi-shield-check"></i> 역할
                  </strong>
                </div>
                <div class="col-8">
                  <span th:switch="${user.role.name()}" class="badge fs-6">
                    <span th:case="'ADMIN'" class="badge badge-outline"
                      >👑 관리자</span
                    >
                    <span th:case="'TEACHER'" class="badge badge-outline"
                      >👨‍🏫 강사</span
                    >
                    <span th:case="'STUDENT'" class="badge badge-outline"
                      >👨‍🎓 학생</span
                    >
                    <span
                      th:case="*"
                      class="badge badge-outline"
                      th:text="${user.role}"
                      >역할</span
                    >
                  </span>
                </div>
              </div>

              <div class="row mb-4" th:if="${user.createdAt != null}">
                <div class="col-4">
                  <strong class="text-muted">
                    <i class="bi bi-calendar-check"></i> 가입일
                  </strong>
                </div>
                <div class="col-8">
                  <span
                    class="text-muted"
                    th:text="${#temporals.format(user.createdAt, 'yyyy년 MM월 dd일 HH:mm')}"
                    >2025년 01월 01일 12:00</span
                  >
                </div>
              </div>

              <div class="row mb-4">
                <div class="col-4">
                  <strong class="text-muted">
                    <i class="bi bi-patch-check"></i> 승인 상태
                  </strong>
                </div>
                <div class="col-8">
                  <span
                    th:if="${user.role.name() == 'ADMIN'}"
                    class="badge bg-secondary"
                    >-</span
                  >
                  <span th:if="${user.role.name() != 'ADMIN'}">
                    <span th:if="${user.approved}" class="badge bg-primary"
                      >승인됨</span
                    >
                    <span
                      th:unless="${user.approved}"
                      class="badge bg-secondary"
                      >대기</span
                    >
                    <small
                      class="text-muted ms-2"
                      th:if="${user.approvedAt != null}"
                    >
                      <i class="bi bi-clock"></i>
                      <span
                        th:text="${#temporals.format(user.approvedAt, 'yyyy-MM-dd HH:mm')}"
                        >-</span
                      >
                    </small>
                  </span>
                </div>
              </div>

              <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                <a th:href="@{/users}" class="btn btn-outline-primary me-md-2">
                  <i class="bi bi-arrow-left"></i> 목록으로
                </a>
                <form
                  th:action="@{'/users/approve/' + ${user.id}}"
                  method="post"
                  th:if="${user.role.name() != 'ADMIN' and !user.approved}"
                  class="d-inline"
                >
                  <button
                    type="submit"
                    class="btn btn-primary"
                    onclick="return confirm('승인하시겠습니까?');"
                  >
                    <i class="bi bi-check2-circle"></i> 승인
                  </button>
                </form>
                <a
                  th:href="@{'/users/edit/' + ${user.id}}"
                  class="btn btn-primary"
                >
                  <i class="bi bi-pencil"></i> 수정
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <div th:replace="_fragments/footer :: footer"></div>
    <div th:replace="_fragments/header :: scripts"></div>
  </body>
</html>
